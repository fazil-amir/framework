"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();$("document").ready(function(){switch($("[data-page-name]").data("page-name")){case"WIDGET_VIEW_ALL_VIEW":var e=new Widget;e.initPagination(),e.initTableSortable(),e.initPushToggle()}});var Widget=function(){function e(){var o=this;_classCallCheck(this,e),this.findAndReplace=function(e,t,n){var o="{{"+t+"}}";return e.replace(o,n).replace(o,n)},this.updateCount=function(e){for(var t=0;t<e.length;t++){e[t].querySelector(".custom-header span").innerHTML=t+1}},this.initPhoto=function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=new ModernFileInput;return o.init($("#"+e),t,n),o},this.fetchTemplate=function(e){return fetch(e,{headers:{"Cache-Control":"no-cache"}}).then(function(e){return e.text()}).then(function(e){return Promise.resolve(e)})},this.handleWidgetItemAddClick=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments[1];o.addBtn.addEventListener("click",function(){e(),setTimeout(function(){o.updateCount(t)},100)})},this.handleWidgetItemDelete=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=arguments[1];document.getElementById(e)&&document.getElementById(e).addEventListener("click",function(t){popup.confirm({content:"Are you sure?",backdrop_close:!1},function(e){e.proceed&&(t.target.parentNode.remove(),o.updateCount(n))})})},this.collapseErrorContent=function(e){for(var t=0;t<e.length;t++){e[t].querySelector(".err-message")&&e[t].classList.remove("toggle-collapse")}},this.form=document.getElementById("widget-submit"),this.content=document.getElementById("widget-content-container"),this.addBtn=document.getElementById("add-btn")}return _createClass(e,[{key:"initPagination",value:function(){(new MakePagination).staticPagination($(".form-records"),10)}},{key:"initTableSortable",value:function(){$(".form-records").tablesorter()}},{key:"initPushToggle",value:function(){new DeleteEntry(".widget-delete-trigger"),new PushToggle(".widget-featured"),new PushToggle(".widget-visibility")}},{key:"getWidgetCommonData",value:function(){return{accessor_name:document.getElementById("accessor-name").value,visibility:document.getElementById("visibility").checked?"on":"off",featured:document.getElementById("featured").checked?"on":"off",language:document.getElementById("language")?document.getElementById("language").value:void 0}}},{key:"saveWidget",value:function(e){var t=this;this.showOverlay();var n=this.form.getAttribute("action"),o={specific:e,common:this.getWidgetCommonData()};fetch(n,{method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(o)}).then(function(e){return e.json()}).then(function(e){t.hideOverlay(),e.error?showMessage(e.message,"error"):showMessage(e.message,"default")}).catch(function(e){console.error("[WIDGET ERROR] : "+e),t.hideOverlay()})}},{key:"showOverlay",value:function(){$(".overlay").addClass("show")}},{key:"hideOverlay",value:function(){$(".overlay").removeClass("show")}},{key:"handleContentCollapse",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",n=1<arguments.length&&void 0!==arguments[1]&&arguments[1];setTimeout(function(){var e=document.getElementById(t);e&&(n&&e.parentNode.classList.add("toggle-collapse"),e.addEventListener("click",function(e){e.target.parentNode.classList.toggle("toggle-collapse")}))},100)}},{key:"collapseOnlyLast",value:function(e){setTimeout(function(){e[e.length-1].classList.toggle("toggle-collapse")},400)}},{key:"getRichDataParsed",value:function(){var e=this.form.getAttribute("data-source");return e?fetch(e,{headers:{"Cache-Control":"no-cache"}}).then(function(e){return e.json()}).then(function(e){return Promise.resolve(e)}):Promise.resolve(!1)}}]),e}();
//# sourceMappingURL=widget.min.js.map
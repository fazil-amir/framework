"use strict";function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var LiveEdit=function(){this.$editKey=$("[data-live-edit-id]"),this.$startBtn,this.$saveBtn,this.$wrapper,this.$resetBtn;var s=this;this.init=function(){this.renderElements(),this.startEditing()},this.setSuccessMessage=function(){var t=$("<div />",{class:"message-wrapper",html:"Page data saved"}).appendTo(this.$wrapper);setTimeout(function(){t.remove()},4e3)},this.startEditing=function(){console.log("Editing started"),this.$editKey.attr("contenteditable",!0),this.$editKey.off("click"),this.$editKey.on("click",function(t){t.preventDefault()}),this.$editKey.on("keydown",function(t){if(t.target.setAttribute("touched",!0),13===t.keyCode)return document.execCommand("insertHTML",!1,"<br><br>"),!1}),this.$startBtn.hide(),this.$saveBtn.show(),this.$resetBtn.show()},this.saveEditing=function(){this.$saveBtn.attr("disabled","disabled"),console.log("Saving data");var t=new FormData;t.append("page-name",$("main").data("page-name"));var e=[];this.$editKey.each(function(){$(this).attr("touched")&&e.push(_defineProperty({},$(this).data("live-edit-id"),$(this).html()))}),t.append("data",JSON.stringify(e)),$.ajax({method:"POST",url:baseURL("panel/live-edit/client/save"),data:t,cache:!1,contentType:!1,processData:!1,dataType:"json"}).done(function(){s.$editKey.removeAttr("contenteditable"),s.$editKey.off("click"),s.$startBtn.show(),s.$saveBtn.hide(),s.$resetBtn.hide(),s.$saveBtn.removeAttr("disabled"),s.setSuccessMessage()})},this.renderElements=function(){var t=$("<button />",{html:"Start Editing",class:"button start"}).on("click",function(){s.startEditing()}),e=$("<button />",{html:"Save Editing",class:"button save"}).on("click",function(){s.saveEditing()}),i=$("<button />",{html:"Reset",class:"button reset"}).on("click",function(){s.resetEditing()}),n=$("<div />",{class:"live-edit-wrapper"}).append($("<div />",{class:"button-wrapper"}).append(t,e,i));$("body").append(n).css({paddingBottom:n.outerHeight()}),this.$startBtn=t,this.$saveBtn=e,this.$wrapper=n,this.$resetBtn=i},this.resetEditing=function(){window.location=window.location.href,this.$startBtn.show(),this.$saveBtn.hide(),this.$resetBtn.hide()},this.init()};new LiveEdit;
//# sourceMappingURL=live-edit.min.js.map